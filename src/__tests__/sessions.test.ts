/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { expect, test } from "vitest";
import { Apideck } from "../index.js";
import { createTestHTTPClient } from "./testclient.js";

test("Sessions Vault Sessions Create", async () => {
  const testHttpClient = createTestHTTPClient("vault.sessionsCreate");

  const apideck = new Apideck({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    apiKey: process.env["APIDECK_API_KEY"] ?? "value",
  });

  const result = await apideck.vault.sessions.create({
    consumerId: "test-consumer",
    appId: "dSBdXd2H6Mqwfg0atXHXYcysLJE9qyn1VwBtXHX",
    session: {
      consumerMetadata: {
        accountName: "SpaceX",
        userName: "Elon Musk",
        email: "elon@musk.com",
        image: "https://www.spacex.com/static/images/share.jpg",
      },
      redirectUri: "https://mysaas.com/dashboard",
      settings: {
        unifiedApis: [
          "crm",
        ],
      },
      theme: {
        favicon: "https://res.cloudinary.com/apideck/icons/intercom",
        logo: "https://res.cloudinary.com/apideck/icons/intercom",
        primaryColor: "#286efa",
        sidepanelBackgroundColor: "#286efa",
        sidepanelTextColor: "#FFFFFF",
        vaultName: "Intercom",
        privacyUrl: "https://compliance.apideck.com/privacy-policy",
        termsUrl:
          "https://www.termsfeed.com/terms-conditions/957c85c1b089ae9e3219c83eff65377e",
      },
      customConsumerSettings: {
        "feature_flag_1": true,
        "tax_rates": [
          {
            "id": "6",
            "label": "6%",
          },
          {
            "id": "21",
            "label": "21%",
          },
        ],
      },
    },
  });
  expect(result.httpMeta.response.status).toBe(200);
  expect(result.createSessionResponse).toBeDefined();
  expect(result.createSessionResponse).toEqual({
    statusCode: 200,
    status: "OK",
    data: {
      sessionUri:
        "http://vault.apideck.com/session/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb25zdW1lcl9pZCI6InRlc3RfdXNlcl9pZCIsImFwcGxpY2F0aW9uX2lkIj",
      sessionToken:
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjb25zdW1lcl9pZCI6InRlc3RfdXNlcl9pZCIsImFwcGxpY2F0aW9uX2lkIj",
    },
  });
});
